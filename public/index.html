<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/farguard-logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#7c3aed" />
    
    <title>FarGuard - Token Approval Manager</title>
    <meta name="description" content="Manage your token approvals securely on Farcaster. Track and revoke risky contract approvals to protect your wallet." />
    
    <!-- REQUIRED: Farcaster Frame Meta Tags -->
    <meta property="fc:frame" content="vNext" />
    <meta property="fc:frame:image" content="https://fgrevoke.vercel.app/farguard-logo.png" />
    <meta property="fc:frame:button:1" content="🛡️ Open FarGuard" />
    <meta property="fc:frame:button:1:action" content="link" />
    <meta property="fc:frame:button:1:target" content="https://fgrevoke.vercel.app" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="FarGuard - Token Approval Manager" />
    <meta property="og:description" content="Manage your token approvals securely on Farcaster" />
    <meta property="og:image" content="https://fgrevoke.vercel.app/farguard-logo.png" />
    
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <!-- Farcaster Mini App SDK -->
    <script type="module">
      // Load SDK from multiple sources
      try {
        const { sdk } = await import('https://esm.sh/@farcaster/miniapp-sdk');
        window.sdk = sdk;
        window.farcasterSdk = sdk;
        console.log('✅ Farcaster SDK loaded successfully');
        
        // Try to call ready immediately
        if (sdk?.actions?.ready) {
          sdk.actions.ready();
          console.log('✅ SDK ready() called immediately');
        }
        
        // Also try after a delay
        setTimeout(() => {
          if (sdk?.actions?.ready) {
            sdk.actions.ready();
            console.log('✅ SDK ready() called after delay');
          }
        }, 1000);
        
      } catch (error) {
        console.log('❌ Failed to load Farcaster SDK:', error);
        
        // Fallback: Try CDN version
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/@farcaster/miniapp-sdk/dist/index.min.js';
        script.onload = () => {
          console.log('✅ Fallback SDK loaded');
          if (window.farcasterSdk?.actions?.ready) {
            window.farcasterSdk.actions.ready();
            console.log('✅ Fallback SDK ready() called');
          }
        };
        document.head.appendChild(script);
      }
    </script>
    
    <!-- Backup ready call on window load -->
    <script>
      window.addEventListener('load', () => {
        setTimeout(() => {
          if (window.sdk?.actions?.ready) {
            window.sdk.actions.ready();
            console.log('✅ Window load SDK ready() called');
          } else if (window.farcasterSdk?.actions?.ready) {
            window.farcasterSdk.actions.ready();
            console.log('✅ Window load farcasterSdk ready() called');
          }
        }, 2000);
      });
    </script>
  </body>
</html>